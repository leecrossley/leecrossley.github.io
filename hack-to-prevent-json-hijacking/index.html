<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hack to Prevent JSON Hijacking | iLee</title>
  <meta name="author" content="Lee Crossley">
  <meta name="description" content="A quick and easy example and explanation of how to prevent 'JSON Hijacking'">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:title" content="Hack to Prevent JSON Hijacking"/>
  <meta property="og:site_name" content="iLee"/>
  <meta property="og:image" content="http://ih0.redbubble.net/image.14354785.9412/sticker,375x360.u2.png" />
  <link rel="alternate" href="/atom.xml" title="iLee" type="application/atom+xml">
  <link rel="shortcut icon" href="/img/ilee.ico">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <style type="text/css">
  /* Inline above the fold styles */
  * { margin: 0px; padding: 0px; }
  body { background-color: rgb(236, 240, 241); color: rgb(68, 68, 68); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; text-shadow: transparent 0px 0px 1px; background-position: initial initial; background-repeat: initial initial; }
  .inner { filter: none; width: 1200px; margin: 30px auto 0px; opacity: 1 !important; }
  .alignleft { float: left; }
  .logo { border-top-left-radius: 15em; border-top-right-radius: 15em; border-bottom-right-radius: 15em; border-bottom-left-radius: 15em; -webkit-box-shadow: rgb(255, 255, 255) 0px 0px 0px 3px inset, rgba(100, 100, 100, 0.2) 0px 4px 8px -2px; box-shadow: rgb(255, 255, 255) 0px 0px 0px 3px inset, rgba(100, 100, 100, 0.2) 0px 4px 8px -2px; background-color: rgb(26, 188, 156); width: 250px; height: 250px; margin: 0px auto 30px; color: rgb(255, 255, 255); border: 3px solid rgb(26, 188, 156); text-align: center; }
  h1, h2, h3, h4, h5, h6 { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
  h1 { font-size: 1.8em; }
  .logo h1 { font-size: 65px; line-height: 65px; margin-top: 54px; }
  a { text-decoration: none; color: rgb(22, 160, 133); }
  .logo h1 a { color: rgb(255, 255, 255); text-decoration: none; display: inline-block; transition: 0.4s; -webkit-transition: 0.4s; }
  .logo h1 span { padding-top: 20px; display: inline-block; clear: left; font-size: 18px; line-height: 23px; width: 220px; }
  .alignright { float: right; }
  #main-col { width: 900px; }
  article { background-color: rgb(255, 255, 255); background-position: initial initial; background-repeat: initial initial; }
  article .post-content { padding: 20px 20px 20px 77px; margin-bottom: 50px; position: relative; }
  article header .icon { width: 32px; height: 32px; margin-right: 25px; position: absolute; top: 20px; left: 20px; color: rgb(22, 160, 133); }
  article header time { color: rgb(153, 153, 153); font-style: normal; font-variant: normal; font-weight: normal; font-size: 0.9em; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; margin-bottom: 5px; display: block; line-height: 1; }
  article header .title { font-weight: normal; }
  article header .title a { color: rgb(68, 68, 68); }
  article .entry { text-align: justify; line-height: 1.6; }
  h2 { font-size: 1.5em; }
  article .entry h1, article .entry h2 { font-weight: normal; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); padding-bottom: 10px; margin-top: 20px; }
  article .entry p, article .entry blockquote, article .entry ul, article .entry ol, article .entry dl, article .entry table, article .entry iframe, article .entry h3, article .entry h4, article .entry h5, article .entry h6, article .entry .video-container { margin-top: 15px; }
  article .entry code, article .entry pre { font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; }
  article .entry code { background-color: rgb(238, 238, 238); color: rgb(102, 102, 102); padding: 0px 5px; margin: 0px 2px; font-size: 0.9em; border: 1px solid rgb(221, 221, 221); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-position: initial initial; background-repeat: initial initial; }
  h3 { font-size: 1.3em; }
  article .entry h3, article .entry h4, article .entry h5, article .entry h6 { font-weight: normal; }
  figure.highlight { background-color: rgb(238, 238, 238); border: 1px solid rgb(221, 221, 221); margin-top: 15px; padding: 7px 15px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; text-shadow: rgb(255, 255, 255) 0px 0px 1px; line-height: 1.6; overflow: auto; position: relative; font-size: 0.9em; background-position: initial initial; background-repeat: initial initial; }
  figure.highlight table { margin-top: 0px; border-spacing: 0px; }
  figure.highlight .gutter { color: rgb(153, 153, 153); padding-right: 15px; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); text-align: right; }
  article .entry pre { background-color: rgb(238, 238, 238); border: 1px solid rgb(221, 221, 221); margin-top: 15px; overflow: auto; padding: 7px 15px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; background-position: initial initial; background-repeat: initial initial; }
  figure.highlight pre { border: none; padding: 0px; margin: 0px; }
  figure.highlight .code { padding-left: 15px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(255, 255, 255); color: rgb(102, 102, 102); }
  #sidebar { width: 270px; line-height: 1.8em; }
  #sidebar .social { padding: 0px; margin: 0px 0px 30px; height: 35px; list-style-type: none; font-family: FontAwesome; }
  #sidebar .social li { float: left; width: 20%; }
  #sidebar .social .icon { margin: 0px auto; display: block; width: 35px; height: 35px; text-align: center; text-decoration: none; line-height: 40px; color: rgb(255, 255, 255); font-size: 22px; border-top-left-radius: 50%; border-top-right-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; -webkit-box-shadow: none; box-shadow: none; transition: all 0.2s ease; -webkit-transition: all 0.2s ease; box-sizing: border-box; background-color: rgb(189, 195, 199); }
  #sidebar .hire-button a { display: block; height: 45px; margin: 30px auto; overflow: hidden; border: 2px solid rgb(22, 160, 133); background-color: rgb(26, 188, 156); transition: background 0.2s ease; -webkit-transition: background 0.2s ease; color: rgb(255, 255, 255); font-size: 1.4em; line-height: 45px; text-align: center; }
  #sidebar .widget { background-color: rgb(255, 255, 255); margin-bottom: 30px; word-wrap: break-word; background-position: initial initial; background-repeat: initial initial; }
  #sidebar .widget ul, #sidebar .widget ol, #sidebar .widget dl { list-style: none; }
  #sidebar .widget .entry { font-size: 0.9em; padding: 15px 20px; }
  #sidebar .widget .title { padding: 15px 20px; font-size: 1em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221); font-weight: normal; }
  .clearfix { zoom: 1; }
  </style>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42989646-1', 'ilee.co.uk');
    ga('send', 'pageview');
  </script>

</head>


<body>
  <div id="content" class="inner">
    <header class="logo alignleft">
      <h1>
        <a href="/">iLee</a>
        <span>I write code that sounds awesome and music that's bug free</span>
      </h1>
    </header>
    <div id="main-col" class="alignright"><div id="wrapper"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      <div class="icon"></div>
      
        <time datetime="2013-10-02T16:32:24.000Z" itemprop="datePublished">2nd Oct 2013</time>
      
      
  
    <h1 class="title" itemprop="name headline">Hack to Prevent JSON Hijacking</h1>
  

    </header>
    <div class="entry" itemprop="articleBody">
      
        <h2>JSON hijacking</h2>
<p>I recently needed to ensure a JSON service response couldn&#39;t be misused via external <a href="http://haacked.com/archive/2009/06/25/json-hijacking.aspx" target="_blank">JSON hijacking</a>. This is a very common problem, especially in older browsers. Fortunately, there&#39;s a nice little hack to prevent the hijack.</p>
<p>Microsoft, Google, Facebook etc are all using variations of this to allow AJAX requests on their (same) domain to have full access, while preventing hijacking by others.</p>
<h2>The hack</h2>
<p>Force requests not to use JSONP and allow the Same Origin Policy to do it&#39;s job, by adding a simple (and evil) endless loop to the start of a JSON response:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">while</span>(<span class="number">1</span>);
</pre></td></tr></table></figure>

<p>Because you aren&#39;t using a JSONP request, you have the ability to modify the response, e.g.</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>JSON.parse(<span class="keyword">this</span>.responseText.slice(<span class="string">"while(1);"</span>.length));
</pre></td></tr></table></figure>

<p>Whereas illegitimate users will find themselves sucked into a black hole.</p>
<p>Facebook use a similar variation to achieve the same result:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">for</span>(;;);
</pre></td></tr></table></figure>

<p>Personally, I&#39;d like to lead the JSON response with the throwing of an error message :)</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">throw</span> <span class="string">"JSON THIEF"</span>;
</pre></td></tr></table></figure>

<h2>Limitations</h2>
<p>Using this quick and easy hack means you don&#39;t need to mess around storing and managing CSRF (cross-site request forgery) tokens. <strong>Winning</strong>. It‘s not however a solution for cross-site request forgery itself. Maybe I’ll cover that on another, less sunny day.</p>

      
    </div>
    <footer>
      
        
<div class="share">
  <a class="icon-facebook" target="_blank" href="http://www.facebook.com/sharer/sharer.php?u=http://ilee.co.uk/hack-to-prevent-json-hijacking"></a>
  <a class="icon-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=Hack%20to%20Prevent%20JSON%20Hijacking&amp;url=http://ilee.co.uk/hack-to-prevent-json-hijacking&amp;via=lee_crossley"></a>
  <a class="icon-google-plus" target="_blank" href="https://plus.google.com/share?url=http://ilee.co.uk/hack-to-prevent-json-hijacking"></a>
  <a class="icon-linkedin" target="_blank" href="http://www.linkedin.com/shareArticle?url=http://ilee.co.uk/hack-to-prevent-json-hijacking&amp;title=Hack%20to%20Prevent%20JSON%20Hijacking"></a>
</div>

        
        
  
  <div class="tags">
    <a href="/tags/javascript/" itemprop="keywords">javascript</a>, <a href="/tags/web/" itemprop="keywords">web</a>
  </div>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view or add comments</noscript>
  </div>
</section>
</div></div>
    <div id="sidebar" class="alignleft"><ul class="social">
  <li class="facebook">
    <a href="https://www.facebook.com/lee.crossley" target="_blank" class="icon"><i class="icon-facebook"></i></a>
  </li>
  <li class="twitter">
    <a href="https://twitter.com/lee_crossley" target="_blank" class="icon"><i class="icon-twitter"></i></a>
  </li>
  <li class="github">
    <a href="https://github.com/leecrossley" target="_blank" class="icon"><i class="icon-github"></i></a>
  </li>
  <li class="google-plus">
    <a href="https://plus.google.com/+LeeCrossley?rel=author" target="_blank" class="icon"><i class="icon-google-plus"></i></a>
  </li>
  <li class="linkedin">
    <a href="http://uk.linkedin.com/in/leecrossley/" target="_blank" class="icon"><i class="icon-linkedin"></i></a>
  </li>
</ul>


  <div class="hire-button">
  <a href="/contact-me"><span>Hire Me</span></a>
</div>

  <div class="widget tag">
<ul class="entry">
  
    <li><a href="/">Home</a></li>
  
    <li><a href="/about-me">About Me</a></li>
  
    <li><a href="/contact-me">Contact Me</a></li>
  
    <li><a href="/archives">Archives</a></li>
  
</ul>
</div>

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/list-node-packages-wo-dependencies/">List Node Packages w/o Dependencies</a>
      </li>
    
      <li>
        <a href="/native-page-transitions-with-phonegap/">Native Page Transitions with PhoneGap</a>
      </li>
    
      <li>
        <a href="/looping-audio-with-phonegap/">Looping Audio with PhoneGap</a>
      </li>
    
      <li>
        <a href="/pause-between-grunt-tasks/">Pause between Grunt Tasks</a>
      </li>
    
      <li>
        <a href="/plugreg-v07-is-now-live/">PlugReg v0.7 Is Now Live</a>
      </li>
    
      <li>
        <a href="/npm-cardiac-arrest/">npm Cardiac Arrest</a>
      </li>
    
      <li>
        <a href="/nesting-ugly-anonymous-functions/">Nesting Ugly Anonymous Functions</a>
      </li>
    
      <li>
        <a href="/grouping-consolelog()-output/">Grouping console.log() Output</a>
      </li>
    
      <li>
        <a href="/multiple-element-swipe-gesture/">Multiple Element Swipe Gesture</a>
      </li>
    
      <li>
        <a href="/using-game-center-with-phonegap/">Using Game Center with PhoneGap</a>
      </li>
    
  </ul>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/android/">android</a><small>7</small></li>
  
    <li><a href="/tags/app/">app</a><small>8</small></li>
  
    <li><a href="/tags/design/">design</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/hack/">hack</a><small>3</small></li>
  
    <li><a href="/tags/html/">html</a><small>7</small></li>
  
    <li><a href="/tags/iphone/">iphone</a><small>16</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>34</small></li>
  
    <li><a href="/tags/phonegap/">phonegap</a><small>13</small></li>
  
    <li><a href="/tags/web/">web</a><small>21</small></li>
  
  </ul>
</div>

</div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2013 Lee Crossley
  
</div>
<div class="clearfix"></div></footer>
  
<script type="text/javascript">
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//ilee.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>


  <link rel="stylesheet" href="/css/style.css" type="text/css">
</body>
</html>