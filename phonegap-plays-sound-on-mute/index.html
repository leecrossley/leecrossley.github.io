<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>PhoneGap Plays Sounds on Mute | iLee</title>
  <meta name="author" content="Lee Crossley">
  <meta name="description" content="By default, the Cordova / PhoneGap media plugin will play audio when the device is set to mute!">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:title" content="PhoneGap Plays Sounds on Mute"/>
  <meta property="og:site_name" content="iLee"/>
  <meta property="og:image" content="http://ilee.co.uk/img/audio-mute.png" />
  <link rel="alternate" href="/atom.xml" title="iLee" type="application/atom+xml">
  <link rel="shortcut icon" href="/img/ilee.ico">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42989646-1', 'ilee.co.uk');
    ga('send', 'pageview');
  </script>

</head>


<body>
  <div id="content" class="inner">
    <header class="logo alignleft">
      <h1>
        <a href="/">iLee</a>
        <span>I write code that sounds awesome and music that&#39;s bug free</span>
      </h1>
    </header>
    <div id="main-col" class="alignright"><div id="wrapper"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      <div class="icon"></div>
      
        <time datetime="2013-11-14T07:56:56.000Z" itemprop="datePublished">14th Nov 2013</time>
      
      
  
    <h1 class="title" itemprop="name headline">PhoneGap Plays Sounds on Mute</h1>
  

    </header>
    <div class="entry" itemprop="articleBody">
      
        <h2 id="the-cordova-phonegap-media-plugin">The Cordova / PhoneGap media plugin</h2>
<p>As part of my recent game development, there&#39;s a requirement to play short audio sound effects, based on user interaction. There are several options available for doing this but I opted for using a native component using the core Apache <a href="http://www.plugreg.com/plugin/apache/cordova-plugin-media" target="_blank">Media Plugin</a>.</p>
<h2 id="working-in-60-seconds-but-">Working in 60 seconds, but...</h2>
<p>It worked like a treat within seconds of wiring it up, but to my horror, the sound samples were still played when the device (iPhone) was muted by the physical mute button!</p>
<p><strong>What the!?</strong> Not great if you want to play my game on a train.</p>
<p><img src="/img/audio-mute.png" alt="Muted Audio"></p>
<h2 id="-why-why-why-http-youtu-be-9hp44eak8lc-t-44s-"><a href="http://youtu.be/9Hp44eaK8Lc?t=44s" target="_blank">Why Why Why</a></h2>
<p>There are various policies that dictate whether or not a sound is played, interrupted or muted. Cordova / PhoneGap creates an audio session, that was originally designed for apps like Spotify and YouTube that want to play media regardless of the phone state and even if the app isn&#39;t open (screen is locked).</p>
<h2 id="the-solution">The solution</h2>
<p>My initial instinct was to query the state of the mute switch, but I really didn&#39;t want to write a plugin just to do that - I might as well switch to another option for playing the sounds in the actual web view.</p>
<p>After delving into the plugin source I found an option, an option (that is not the default) to make the audio session obey the mute switch. <code>playAudioWhenScreenIsLocked</code>. Yes that&#39;s right, setting playAudioWhenScreenIsLocked will force the plugin to react to the state of the hardware mute button.</p>
<h2 id="full-example">Full example</h2>
<p>Here&#39;s the code you need to play audio that obeys the mute switch:</p>
<h3 id="install-the-media-plugin">Install the media plugin</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$ cordova plugin add https://github.com/apache/cordova-plugin-media.git
</pre></td></tr></table></figure>

<h3 id="in-your-javascript">In your JavaScript</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="keyword">var</span> playAudio = <span class="function"><span class="keyword">function</span> <span class="params">(file)</span> {</span>
    <span class="keyword">var</span> media = <span class="keyword">new</span> Media(file);
    media.play({ playAudioWhenScreenIsLocked : <span class="literal">false</span> });
};
</pre></td></tr></table></figure>

<p>An incontinent mute, goes without saying.</p>

      
    </div>
    <footer>
      
        
<div class="share">
  <a class="icon-facebook" target="_blank" href="http://www.facebook.com/sharer/sharer.php?u=http://ilee.co.uk/phonegap-plays-sound-on-mute"></a>
  <a class="icon-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=PhoneGap%20Plays%20Sounds%20on%20Mute&amp;url=http://ilee.co.uk/phonegap-plays-sound-on-mute&amp;via=lee_crossley"></a>
  <a class="icon-google-plus" target="_blank" href="https://plus.google.com/share?url=http://ilee.co.uk/phonegap-plays-sound-on-mute"></a>
  <a class="icon-linkedin" target="_blank" href="http://www.linkedin.com/shareArticle?url=http://ilee.co.uk/phonegap-plays-sound-on-mute&amp;title=PhoneGap%20Plays%20Sounds%20on%20Mute"></a>
</div>

        
        
  
  <div class="tags">
    <a href="/tags/phonegap/" itemprop="keywords">phonegap</a>, <a href="/tags/iphone/" itemprop="keywords">iphone</a>, <a href="/tags/android/" itemprop="keywords">android</a>, <a href="/tags/javascript/" itemprop="keywords">javascript</a>
  </div>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view or add comments</noscript>
  </div>
</section>
</div></div>
    <div id="sidebar" class="alignleft"><ul class="social">
  <li class="facebook">
    <a href="https://www.facebook.com/lee.crossley" target="_blank" class="icon"><i class="icon-facebook"></i></a>
  </li>
  <li class="twitter">
    <a href="https://twitter.com/lee_crossley" target="_blank" class="icon"><i class="icon-twitter"></i></a>
  </li>
  <li class="github">
    <a href="https://github.com/leecrossley" target="_blank" class="icon"><i class="icon-github"></i></a>
  </li>
  <li class="google-plus">
    <a href="https://plus.google.com/+LeeCrossley?rel=author" target="_blank" class="icon"><i class="icon-google-plus"></i></a>
  </li>
  <li class="linkedin">
    <a href="http://uk.linkedin.com/in/leecrossley/" target="_blank" class="icon"><i class="icon-linkedin"></i></a>
  </li>
</ul>


  <div class="hire-button">
  <a href="/contact-me"><span>Hire Me</span></a>
</div>

  <div class="widget tag">
<ul class="entry">
  
    <li><a href="/">Home</a></li>
  
    <li><a href="/about-me">About Me</a></li>
  
    <li><a href="/contact-me">Contact Me</a></li>
  
    <li><a href="/archives">Archives</a></li>
  
</ul>
</div>

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/dotject-quick-js-object-composition/">dotject - Quick JS Object Composition</a>
      </li>
    
      <li>
        <a href="/json5-is-pointless-and-unimaginative/">JSON5 Is Pointless and Unimaginative</a>
      </li>
    
      <li>
        <a href="/sat-nav-map-directions-for-phonegap/">Sat Nav Map Directions for PhoneGap</a>
      </li>
    
      <li>
        <a href="/are-you-a-dot-guru/">Are You a Dot Guru?</a>
      </li>
    
      <li>
        <a href="/debugging-wp8-in-phonegap/">Debugging WP8 in PhoneGap</a>
      </li>
    
      <li>
        <a href="/new-features-in-grunt-timer-v03/">New Features in grunt-timer v0.3</a>
      </li>
    
      <li>
        <a href="/ditch-the-www-subdomain/">Ditch the www Subdomain</a>
      </li>
    
      <li>
        <a href="/mobile-ux-to-impact-seo/">Mobile UX to Impact SEO</a>
      </li>
    
      <li>
        <a href="/learn-nodejs-in-2014/">Learn nodejs in 2014</a>
      </li>
    
      <li>
        <a href="/using-npm-in-europe/">Using npm in Europe</a>
      </li>
    
  </ul>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/android/">android</a><small>8</small></li>
  
    <li><a href="/tags/app/">app</a><small>9</small></li>
  
    <li><a href="/tags/design/">design</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/hack/">hack</a><small>3</small></li>
  
    <li><a href="/tags/html/">html</a><small>8</small></li>
  
    <li><a href="/tags/iphone/">iphone</a><small>17</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>43</small></li>
  
    <li><a href="/tags/phonegap/">phonegap</a><small>15</small></li>
  
    <li><a href="/tags/web/">web</a><small>25</small></li>
  
    <li><a href="/tags/wp8/">wp8</a><small>2</small></li>
  
  </ul>
</div>

</div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 Lee Crossley
  
</div>
<div class="clearfix"></div></footer>
  
<script type="text/javascript">
(function(){
  var dsq = document.createElement("script");
  dsq.type = "text/javascript";
  dsq.async = true;
  dsq.src = "//ilee.disqus.com/embed.js";
  (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
}());
</script>


</body>
</html>